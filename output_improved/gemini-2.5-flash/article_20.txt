The <model>ProteinMPNN-XL</model> architecture is an advanced iterative message-passing neural network designed for *de novo* protein backbone generation and sequence design. It extends previous Graph Neural Network (GNN) approaches by incorporating a novel transformer-like attention mechanism over the residue graph, allowing for richer contextual integration across distant residues. The model operates directly on 3D protein coordinates, predicting amino acid types and associated confidence scores given a target backbone structure. This architecture significantly improves long-range dependencies modeling compared to earlier iterations, which often struggled with intricate protein folds requiring extensive non-local interactions.

For training, a comprehensive dataset of experimental protein structures was curated from the Protein Data Bank (PDB), comprising structures resolved to better than 2.5 Å resolution with sequence identity below 30% to prevent redundancy. This dataset was further processed by removing structures with missing backbone atoms or significant disorder. Each protein structure was then preprocessed to extract Cα coordinates, residue types, and a local frame representation for each residue, which serves as input to the GNN. Data augmentation techniques, including random rotations, translations, and noise injection to backbone coordinates, were applied on-the-fly to enhance generalization and robustness against minor structural perturbations.

Optimization of <model>ProteinMPNN-XL</model> employed a variant of the AdamW optimizer with a decoupled weight decay of 0.01. A cosine learning rate schedule was utilized, warming up linearly for the first 5,000 steps to a peak learning rate of 1e-4, then decaying to 1e-6. The model was trained using a global batch size of 1024 protein graphs, with gradient accumulation over 4 steps to achieve this effective batch size. The primary loss function was a multi-task objective combining cross-entropy for residue type prediction and an auxiliary mean squared error loss on local frame prediction to guide geometric consistency. The entire training process, encompassing several stages of curriculum learning for increasingly complex design tasks, spanned <training>approximately 6 weeks</training>.